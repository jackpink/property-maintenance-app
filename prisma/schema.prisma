// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}
datasource db {
  provider = "mysql"
  url = env("DATABASE_URL")
  relationMode = "prisma"
}


model Room {
  id        String @id @default(cuid())
  createdAt DateTime @default(now())
  label     String 
  order     Int?
  Level     Level @relation(fields: [levelId], references: [id])
  levelId   String
  jobs      Job[]
  photos    Photo[]

  @@index([levelId])
}

model Level {
  id        String @id @default(cuid())
  createdAt DateTime @default(now())
  label     String
  order     Int?
  rooms     Room[]
  Property Property @relation(fields: [propertyId], references: [id])
  propertyId String

  @@index([propertyId])
}

model Property {
  id            String @id @default(cuid())
  createdAt     DateTime @default(now())
  apartment     String?
  streetNumber  String
  street        String
  suburb        String
  postcode      String
  state         String
  country       String
  levels        Level[]
  jobs          Job[]
  
}

model Document {
  id        String @id @default(cuid())
  createdAt DateTime @default(now())
  filename  String
  url       String
  Job       Job? @relation(fields: [jobId], references: [id])
  jobId     String

  @@index([jobId])
}

model Photo {
  id        String @id @default(cuid())
  createdAt DateTime @default(now())
  filename  String
  directory       String
  Job       Job? @relation(fields: [jobId], references: [id])
  jobId     String?
  Room      Room? @relation(fields: [roomId], references: [id])
  roomId    String?

  @@index([jobId])
  @@index([roomId])
}

model Job {
  id        String @id @default(cuid())
  createdAt DateTime @default(now())
  title     String
  Property  Property @relation(fields: [propertyId], references: [id])
  propertyId  String
  documents Document[]
  photos    Photo[]
  rooms     Room[]
  date      DateTime
  TradeUser TradeUser @relation(fields: [tradeUserId], references: [id])
  tradeUserId String

  @@index([propertyId])
  @@index([tradeUserId])
}

model TradeUser {
  id        String @id
  createdAt DateTime @default(now())
  jobs      Job[]
  companyName String
}
